import{r as t,_ as R,u as S,R as x,T as k,a as O,c as T,x as P,P as i,b as F,j as e,y as w,F as j,D as _,aC as C}from"./index-BFN8OuE8.js";import{C as A,a as B}from"./CCardBody-wuuvjtKP.js";import{C as V}from"./CCardHeader-CJsmVxQF.js";var h=t.forwardRef(function(s,d){var p=s.children,v=s.className,n=s.color,u=n===void 0?"primary":n,c=s.dismissible,a=s.variant,m=s.visible,l=m===void 0?!0:m,r=s.onClose,f=R(s,["children","className","color","dismissible","variant","visible","onClose"]),o=t.useRef(null),g=S(d,o),y=t.useState(l),E=y[0],b=y[1];return t.useEffect(function(){b(l)},[l]),x.createElement(k,{in:E,mountOnEnter:!0,nodeRef:o,onExit:r,timeout:150,unmountOnExit:!0},function(N){return x.createElement("div",O({className:T("alert",a==="solid"?"bg-".concat(u," text-white"):"alert-".concat(u),{"alert-dismissible fade":c,show:N==="entered"},v),role:"alert"},f,{ref:g}),p,c&&x.createElement(P,{onClick:function(){return b(!1)}}))})});h.propTypes={children:i.node,className:i.string,color:F.isRequired,dismissible:i.bool,onClose:i.func,variant:i.string,visible:i.bool};h.displayName="CAlert";const q=()=>{const[s,d]=t.useState(null),[p,v]=t.useState(!1),[n,u]=t.useState(""),[c,a]=t.useState("");t.useEffect(()=>{(async()=>{var f;try{const o=await C("/verify/check_user_verification");d((f=o.data.body[0])==null?void 0:f.email_verified)}catch(o){console.error("Error checking user status:",o),a("خطا في التحقق")}})()},[]);const m=async()=>{try{const r=await C("/verify/send_otp");v(!0),a("تم إرسال الرمز")}catch(r){console.error("Error sending OTP:",r),a("خطأ في ارسال الرمز")}},l=async()=>{try{const r=await C("/verify/verify",{code:n});a(r.data.message),r.data&&d(!0)}catch(r){console.error("Error verifying OTP:",r),a("خطا في التحقق من الرمز")}};return e.jsx("div",{className:"d-flex justify-content-center align-items-center vh-70",children:e.jsxs(A,{children:[e.jsx(V,{className:"text-center",children:"تأكيد الهوية"}),e.jsxs(B,{children:[c&&e.jsx(h,{color:"info",children:c}),s===null&&e.jsx("p",{children:"جاري التحقق..."}),s===!0&&e.jsx(h,{color:"success",children:"تم التحقق من الهوية"}),s===!1&&e.jsx(e.Fragment,{children:e.jsx(w,{children:p?e.jsxs(e.Fragment,{children:[e.jsx(_,{type:"text",placeholder:"Enter OTP",value:n,onChange:r=>u(r.target.value),className:"mb-3"}),e.jsx(j,{color:"success",onClick:l,disabled:!n,children:"تأكيد الهوية"})]}):e.jsx(e.Fragment,{children:e.jsx(j,{color:"primary",onClick:m,children:"إرسال الرمز للايميل المسجل"})})})})]})]})})};export{q as default};
